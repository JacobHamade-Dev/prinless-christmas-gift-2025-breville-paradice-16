<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>For My Little Koala Bear Princess üê®‚ú® | Your Special Gift Guide</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800;900&family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800;900&family=Permanent+Marker&family=Inter:wght@300;400;600;700&family=Playfair+Display:wght@600;700&family=Dancing+Script:wght@600;700&display=swap');

        * {
            scroll-behavior: smooth;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Outfit', 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: 
                radial-gradient(ellipse at 15% 20%, rgba(255, 20, 147, 0.18) 0%, transparent 42%),
                radial-gradient(ellipse at 85% 80%, rgba(255, 105, 180, 0.22) 0%, transparent 52%),
                radial-gradient(ellipse at 50% 50%, rgba(255, 182, 193, 0.15) 0%, transparent 62%),
                radial-gradient(circle at 30% 70%, rgba(255, 192, 203, 0.2) 0%, transparent 48%),
                radial-gradient(circle at 70% 30%, rgba(255, 240, 245, 0.28) 0%, transparent 58%),
                conic-gradient(from 180deg at 50% 50%, 
                    #FFF8FA 0deg,
                    #FFE4E9 60deg,
                    #FFB6C1 120deg,
                    #FF69B4 180deg,
                    #FFB6C1 240deg,
                    #FFE4E9 300deg,
                    #FFF8FA 360deg);
            background-size: 260% 260%, 260% 260%, 210% 210%, 310% 310%, 310% 310%, 100% 100%;
            animation: gradientShift 35s ease-in-out infinite;
            background-attachment: fixed;
            will-change: auto;
            color: #7a3d5c;
            position: relative;
            overflow-x: hidden;
            font-weight: 400;
            letter-spacing: -0.01em;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%, 100% 50%, 50% 0%, 0% 50%, 100% 100%, 0% 0%; }
            33% { background-position: 50% 75%, 50% 25%, 75% 50%, 50% 75%, 50% 50%, 50% 50%; }
            66% { background-position: 100% 50%, 0% 50%, 50% 100%, 100% 50%, 0% 0%, 100% 100%; }
            100% { background-position: 0% 50%, 100% 50%, 50% 0%, 0% 50%, 100% 100%, 0% 0%; }
        }



        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 30% 40%, rgba(255, 255, 255, 0.15) 0%, transparent 45%),
                radial-gradient(circle at 70% 60%, rgba(255, 182, 193, 0.2) 0%, transparent 48%),
                radial-gradient(ellipse at 50% 20%, rgba(255, 105, 180, 0.08) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
            animation: overlayShift 30s cubic-bezier(0.4, 0, 0.6, 1) infinite;
            backdrop-filter: blur(0.5px);
        }

        @keyframes overlayShift {
            0% { transform: translate(0, 0) scale(1); }
            33% { transform: translate(5%, 5%) scale(1.1); }
            66% { transform: translate(-5%, -5%) scale(0.9); }
            100% { transform: translate(0, 0) scale(1); }
        }

        h1, h2, h3, h4 {
            font-family: 'Plus Jakarta Sans', 'Outfit', sans-serif;
            font-weight: 800;
            text-shadow: 
                0 2px 8px rgba(255, 182, 193, 0.7),
                0 4px 16px rgba(255, 105, 180, 0.5),
                0 8px 24px rgba(255, 182, 193, 0.4),
                0 0 30px rgba(255, 105, 180, 0.3),
                0 1px 3px rgba(255, 20, 147, 0.2);
            animation: gentleGlow 6s ease-in-out infinite alternate;
            will-change: auto;
            letter-spacing: -0.02em;
            line-height: 1.2;
        }

        @keyframes gentleGlow {
            from { 
                text-shadow: 
                    0 2px 4px rgba(255, 182, 193, 0.6),
                    0 4px 8px rgba(255, 105, 180, 0.4),
                    0 8px 16px rgba(255, 182, 193, 0.3),
                    0 0 20px rgba(255, 105, 180, 0.2);
            }
            to { 
                text-shadow: 
                    0 2px 6px rgba(255, 182, 193, 0.8),
                    0 4px 12px rgba(255, 105, 180, 0.6),
                    0 8px 24px rgba(255, 182, 193, 0.5),
                    0 0 30px rgba(255, 105, 180, 0.4),
                    0 0 40px rgba(255, 182, 193, 0.2);
            }
        }

        h1 {
            color: #D81B60;
            -webkit-text-stroke: 1.5px rgba(255, 255, 255, 0.8);
            text-stroke: 1.5px rgba(255, 255, 255, 0.8);
            paint-order: stroke fill;
            filter: drop-shadow(0 3px 6px rgba(255, 20, 147, 0.4)) drop-shadow(0 0 20px rgba(255, 105, 180, 0.3));
        }

        @keyframes gradientText {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        /* Sparkle Container */
        #sparkle-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }

        .sparkle {
            position: absolute;
            color: #FFB6C1;
            font-size: 20px;
            animation: sparkleFloat 8s infinite ease-in-out;
            opacity: 0;
            filter: drop-shadow(0 0 6px rgba(255, 182, 193, 0.6));
            will-change: auto;
        }

        /* Smooth Page Transitions */
        #app-content {
            animation: fadeInUp 0.6s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Parallax-like effect for sections */
        section {
            transition: transform 0.3s ease-out, box-shadow 0.3s ease;
        }

        section:hover {
            transform: translateY(-2px);
        }

        /* Enhanced Button Interactions with Ripple */
        button, .filter-btn {
            transition: transform 0.25s ease-out, box-shadow 0.25s ease-out, background-color 0.25s ease-out;
            position: relative;
            overflow: hidden;
        }

        button::after, .filter-btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        button:hover::after, .filter-btn:hover::after {
            width: 300px;
            height: 300px;
        }

        button:active, .filter-btn:active {
            transform: scale(0.96) translateZ(-2px);
        }

        /* Input Field Enhancements */
        input[type="text"], input[type="checkbox"] {
            transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
        }

        input[type="text"]:focus {
            transform: scale(1.015);
            box-shadow: 
                0 0 25px rgba(255, 105, 180, 0.5),
                0 0 50px rgba(255, 182, 193, 0.3),
                0 4px 15px rgba(255, 20, 147, 0.2) !important;
            border-color: #FF69B4 !important;
        }

        /* Smooth Accordion Transitions */
        #content-* {
            transition: all 0.3s ease;
        }

        @keyframes sparkleFloat {
            0% {
                transform: translateY(100vh) translateX(0) scale(0.2);
                opacity: 0;
            }
            5% {
                opacity: 0.3;
            }
            10% {
                opacity: 1;
                transform: translateY(90vh) translateX(calc(var(--drift, 0px) * 0.3)) scale(0.6);
            }
            30% {
                transform: translateY(70vh) translateX(calc(var(--drift, 0px) * 0.6)) scale(0.9);
            }
            50% {
                transform: translateY(50vh) translateX(var(--drift, 0px)) scale(1.1);
            }
            70% {
                transform: translateY(30vh) translateX(calc(var(--drift, 0px) * 0.8)) scale(1);
            }
            90% {
                opacity: 1;
                transform: translateY(10vh) translateX(calc(var(--drift, 0px) * 0.5)) scale(0.7);
            }
            95% {
                opacity: 0.5;
            }
            100% {
                transform: translateY(-100px) translateX(0) scale(0.2);
                opacity: 0;
            }
        }

        .sparkle-static {
            display: inline-block;
        }

        @keyframes sparkleTwinkle {
            0%, 100% { 
                opacity: 0.6; 
                transform: scale(1);
                filter: drop-shadow(0 0 6px rgba(255, 105, 180, 0.8)) drop-shadow(0 0 10px rgba(255, 20, 147, 0.4));
            }
            25% {
                opacity: 0.9;
                transform: scale(1.25);
                filter: drop-shadow(0 0 10px rgba(255, 20, 147, 0.9)) drop-shadow(0 0 18px rgba(255, 105, 180, 0.6));
            }
            50% { 
                opacity: 1; 
                transform: scale(1.5);
                filter: drop-shadow(0 0 15px rgba(255, 20, 147, 1)) drop-shadow(0 0 25px rgba(255, 105, 180, 0.8));
            }
            75% {
                opacity: 0.9;
                transform: scale(1.25);
                filter: drop-shadow(0 0 10px rgba(255, 20, 147, 0.9)) drop-shadow(0 0 18px rgba(255, 105, 180, 0.6));
            }
        }

        /* Chart Container with Advanced Glassmorphism */
        .chart-wrapper {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
            border: 3px solid transparent;
            border-radius: 20px;
            padding: 20px;
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.95) 0%,
                rgba(255, 240, 245, 0.9) 50%,
                rgba(255, 255, 255, 0.95) 100%) padding-box,
                linear-gradient(135deg, #FF69B4, #FFB6C1, #FFC0CB, #FF69B4) border-box;
            background-size: 200% 200%, 200% 200%;
            animation: gradientShift 5s ease infinite;
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            box-shadow: 
                0 10px 40px rgba(255, 182, 193, 0.4),
                inset 0 0 30px rgba(255, 182, 193, 0.15),
                0 0 50px rgba(255, 105, 180, 0.25),
                inset 0 1px 0 rgba(255, 255, 255, 0.6);
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transform-style: preserve-3d;
        }

        .chart-wrapper::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(135deg, #FF69B4, #FFB6C1, #FFC0CB, #FF69B4);
            background-size: 400% 400%;
            border-radius: inherit;
            z-index: -1;
            opacity: 0;
            animation: borderGlow 4s ease infinite;
            filter: blur(10px);
            transition: opacity 0.5s ease;
        }

        .chart-wrapper:hover::before {
            opacity: 0.5;
        }

        .chart-wrapper:hover {
            transform: scale(1.04) translateY(-6px);
            box-shadow: 
                0 18px 60px rgba(255, 20, 147, 0.45),
                inset 0 0 50px rgba(255, 182, 193, 0.3),
                0 0 80px rgba(255, 105, 180, 0.45),
                inset 0 1px 0 rgba(255, 255, 255, 0.85),
                0 0 100px rgba(255, 20, 147, 0.25);
        }

        /* Enhanced White Cards with Premium Glassmorphism */
        .bg-white {
            background: linear-gradient(145deg, 
                rgba(255, 255, 255, 0.93) 0%,
                rgba(255, 245, 250, 0.88) 25%,
                rgba(255, 240, 245, 0.9) 50%,
                rgba(255, 245, 250, 0.88) 75%,
                rgba(255, 255, 255, 0.93) 100%) !important;
            backdrop-filter: blur(25px) saturate(200%);
            -webkit-backdrop-filter: blur(25px) saturate(200%);
            border: 1px solid rgba(255, 182, 193, 0.3);
            box-shadow: 
                0 10px 40px rgba(255, 105, 180, 0.35),
                inset 0 0 25px rgba(255, 182, 193, 0.15),
                0 0 50px rgba(255, 105, 180, 0.2),
                0 2px 10px rgba(255, 20, 147, 0.1);
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .bg-white:hover {
            transform: translateY(-3px);
            box-shadow: 
                0 15px 50px rgba(255, 105, 180, 0.45),
                inset 0 0 35px rgba(255, 182, 193, 0.2),
                0 0 70px rgba(255, 105, 180, 0.3),
                0 5px 15px rgba(255, 20, 147, 0.15);
            border-color: rgba(255, 105, 180, 0.5);
        }

        @media (min-width: 768px) {
            .chart-wrapper {
                height: 350px;
            }
        }

        /* Enhanced Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
        }
        ::-webkit-scrollbar-track {
            background: linear-gradient(180deg, #FFE4E9, #FFB6C1);
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #FF69B4, #FFB6C1);
            border-radius: 10px;
            box-shadow: inset 0 0 6px rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, #FF1493, #FF69B4);
            box-shadow: inset 0 0 8px rgba(255, 255, 255, 0.4),
                        0 0 10px rgba(255, 105, 180, 0.5);
        }

        /* App Content Transitions */
        #app-content {
            transition: opacity 0.3s ease, transform 0.3s ease;
        }

        /* Card Hover Effects with Advanced 3D Glassmorphism */
        .ingredient-card {
            transition: all 0.6s cubic-bezier(0.23, 1, 0.32, 1);
            position: relative;
            background: linear-gradient(145deg, 
                rgba(255, 255, 255, 0.92) 0%,
                rgba(255, 245, 250, 0.88) 30%,
                rgba(255, 240, 245, 0.9) 50%,
                rgba(255, 245, 250, 0.88) 70%,
                rgba(255, 255, 255, 0.92) 100%);
            backdrop-filter: blur(25px) saturate(200%);
            -webkit-backdrop-filter: blur(25px) saturate(200%);
            border: 2px solid rgba(255, 182, 193, 0.35);
            contain: layout style paint;
        }
        .ingredient-card:hover {
            transform: translateY(-12px) scale(1.03) rotateX(3deg) rotateY(-1deg);
            box-shadow: 
                0 30px 60px -15px rgba(255, 20, 147, 0.4),
                0 20px 40px -10px rgba(255, 105, 180, 0.5),
                inset 0 0 50px rgba(255, 182, 193, 0.35),
                0 0 80px rgba(255, 105, 180, 0.35),
                0 0 100px rgba(255, 182, 193, 0.2);
            border-color: rgba(255, 105, 180, 0.7);
            background: linear-gradient(145deg, 
                rgba(255, 255, 255, 0.97) 0%,
                rgba(255, 245, 250, 0.95) 30%,
                rgba(255, 240, 245, 0.96) 50%,
                rgba(255, 245, 250, 0.95) 70%,
                rgba(255, 255, 255, 0.97) 100%);
        }
        .ingredient-card:hover::before {
            content: '‚ú®üíñ‚ú®';
            position: absolute;
            top: -18px;
            right: -18px;
            font-size: 32px;
            animation: sparkleTwinkle 0.7s infinite;
            z-index: 1;
            filter: drop-shadow(0 0 12px rgba(255, 105, 180, 1)) drop-shadow(0 0 20px rgba(255, 20, 147, 0.6));
        }
        .ingredient-card:hover::after {
            content: '';
            position: absolute;
            top: -4px;
            left: -4px;
            right: -4px;
            bottom: -4px;
            background: linear-gradient(135deg, 
                #FF1493 0%, 
                #FF69B4 25%, 
                #FFB6C1 50%, 
                #FF69B4 75%, 
                #FF1493 100%);
            background-size: 400% 400%;
            border-radius: inherit;
            z-index: -1;
            animation: borderGlow 3s ease infinite;
            opacity: 0.8;
            filter: blur(12px);
        }

        @keyframes borderGlow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        /* Navigation Active State with Ultra-Modern Effects */
        .nav-btn.active {
            background: linear-gradient(135deg, 
                #FF1493 0%, 
                #FF69B4 25%, 
                #FFB6C1 50%, 
                #FF69B4 75%, 
                #FF1493 100%);
            background-size: 300% 300%;
            animation: gradientShift 5s ease infinite, navPulse 2s ease-in-out infinite;
            color: white;
            box-shadow: 
                0 10px 30px rgba(255, 20, 147, 0.5),
                0 5px 15px rgba(255, 105, 180, 0.6),
                inset 0 0 25px rgba(255, 255, 255, 0.45),
                0 0 40px rgba(255, 105, 180, 0.45),
                0 0 60px rgba(255, 20, 147, 0.25);
            transform: scale(1.08) translateY(-2px);
            border: 1px solid rgba(255, 255, 255, 0.4);
            backdrop-filter: blur(15px);
            font-weight: 600;
        }

        @keyframes navPulse {
            0%, 100% { box-shadow: 
                0 10px 30px rgba(255, 20, 147, 0.5),
                0 5px 15px rgba(255, 105, 180, 0.6),
                inset 0 0 25px rgba(255, 255, 255, 0.45),
                0 0 40px rgba(255, 105, 180, 0.45),
                0 0 60px rgba(255, 20, 147, 0.25); }
            50% { box-shadow: 
                0 10px 35px rgba(255, 20, 147, 0.6),
                0 5px 20px rgba(255, 105, 180, 0.7),
                inset 0 0 30px rgba(255, 255, 255, 0.5),
                0 0 50px rgba(255, 105, 180, 0.5),
                0 0 75px rgba(255, 20, 147, 0.3); }
        }

        .nav-btn {
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
            border-radius: 8px;
            backdrop-filter: blur(5px);
        }

        .nav-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s ease;
        }

        .nav-btn:hover::before {
            left: 100%;
        }

        .nav-btn:hover {
            background: linear-gradient(145deg, 
                rgba(255, 182, 193, 0.65), 
                rgba(255, 192, 203, 0.55),
                rgba(255, 240, 245, 0.6));
            transform: translateY(-4px) scale(1.04);
            box-shadow: 
                0 8px 25px rgba(255, 105, 180, 0.55),
                inset 0 0 20px rgba(255, 255, 255, 0.3),
                0 0 35px rgba(255, 105, 180, 0.35),
                0 0 50px rgba(255, 182, 193, 0.2);
            border-color: rgba(255, 105, 180, 0.4);
        }

        .nav-btn:hover::after {
            content: '‚ú®';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation: sparkleTwinkle 1s infinite;
            pointer-events: none;
        }

        /* Pink Glow Effect Enhanced */
        .pink-glow {
            text-shadow: 
                0 0 10px rgba(255, 182, 193, 0.9),
                0 0 20px rgba(255, 105, 180, 0.7),
                0 0 30px rgba(255, 105, 180, 0.5),
                0 0 40px rgba(255, 182, 193, 0.3);
            animation: textPulse 3s ease-in-out infinite alternate;
            filter: drop-shadow(0 2px 4px rgba(255, 182, 193, 0.5));
        }

        @keyframes textPulse {
            from {
                text-shadow: 
                    0 0 10px rgba(255, 182, 193, 0.9),
                    0 0 20px rgba(255, 105, 180, 0.7),
                    0 0 30px rgba(255, 105, 180, 0.5),
                    0 0 40px rgba(255, 182, 193, 0.3);
            }
            to {
                text-shadow: 
                    0 0 15px rgba(255, 182, 193, 1),
                    0 0 30px rgba(255, 105, 180, 0.9),
                    0 0 45px rgba(255, 105, 180, 0.7),
                    0 0 60px rgba(255, 182, 193, 0.5);
            }
        }

        /* ===== MOBILE OPTIMIZATION ===== */
        /* Optimized for iPhone and mobile devices */
        
        @media (max-width: 768px) {
            /* Reduce background animation complexity for performance */
            body {
                background-size: 200% 200%, 200% 200%, 150% 150%, 200% 200%, 200% 200%, 100% 100%;
                animation: gradientShift 35s ease infinite;
            }

            body::before {
                animation: overlayShift 40s ease infinite;
            }

            /* Mobile typography - larger for readability */
            body {
                font-size: 16px;
                line-height: 1.6;
            }

            h1 {
                font-size: 2rem !important;
                line-height: 1.2;
            }

            h2 {
                font-size: 1.75rem !important;
                line-height: 1.3;
            }

            h3 {
                font-size: 1.5rem !important;
                line-height: 1.3;
            }

            h4 {
                font-size: 1.25rem !important;
            }

            /* Mobile navigation - full width buttons with better spacing */
            .nav-btn {
                min-height: 48px;
                padding: 14px 20px !important;
                font-size: 1rem;
                margin-bottom: 8px;
                width: 100%;
                text-align: center;
                display: block;
                border-radius: 12px !important;
            }

            nav .flex.items-center.space-x-2 {
                flex-direction: column;
                align-items: stretch;
                gap: 8px;
            }

            .nav-btn.active {
                transform: scale(1.02);
            }

            .nav-btn:hover {
                transform: translateY(0) scale(1.0);
            }

            /* Reduce 3D effects on mobile for performance */
            .ingredient-card {
                perspective: none;
                transform-style: flat;
            }

            .ingredient-card:hover {
                transform: translateY(-6px) scale(1.01);
                box-shadow: 
                    0 15px 30px rgba(255, 20, 147, 0.3),
                    0 10px 20px rgba(255, 105, 180, 0.4),
                    inset 0 0 25px rgba(255, 182, 193, 0.2);
            }

            /* Touch-friendly card spacing */
            #ingredientGrid {
                gap: 1rem !important;
            }

            /* Larger touch targets for inputs */
            input[type="text"] {
                min-height: 48px;
                font-size: 16px; /* Prevents iOS zoom on focus */
                padding: 12px 16px;
            }

            input[type="checkbox"] {
                width: 20px;
                height: 20px;
                min-width: 20px;
                min-height: 20px;
            }

            /* Mobile-friendly buttons */
            button, .filter-btn {
                min-height: 44px;
                padding: 10px 16px;
                font-size: 0.95rem;
            }

            /* Reduce animation intensity on mobile */
            button:hover::after, .filter-btn:hover::after {
                width: 200px;
                height: 200px;
            }

            /* Chart optimization */
            .chart-wrapper {
                height: 250px !important;
                max-height: 300px;
                padding: 15px;
            }

            .chart-wrapper:hover {
                transform: scale(1) translateY(0);
            }

            /* Cards - better mobile spacing */
            .bg-white {
                padding: 1.25rem !important;
                margin-bottom: 1rem;
            }

            .bg-white:hover {
                transform: translateY(0);
            }

            /* Reduce sparkle count on mobile */
            .sparkle {
                font-size: 16px;
            }

            /* Mobile footer */
            footer {
                padding: 2rem 1rem !important;
            }

            /* Accordion touch targets */
            button[onclick*="toggleAccordion"] {
                min-height: 48px;
                padding: 16px !important;
            }

            /* Reduce shadows for better performance */
            section:hover {
                transform: none;
            }

            /* Navigation container */
            nav {
                position: sticky;
                top: 0;
            }

            .overflow-x-auto {
                -webkit-overflow-scrolling: touch;
            }

            /* Prevent text size adjustment on orientation change */
            html {
                -webkit-text-size-adjust: 100%;
                text-size-adjust: 100%;
            }
        }

        /* Extra small devices (iPhone SE, etc) */
        @media (max-width: 375px) {
            h1 {
                font-size: 1.75rem !important;
            }

            h2 {
                font-size: 1.5rem !important;
            }

            .nav-btn {
                font-size: 0.85rem;
                padding: 10px 12px !important;
            }

            .chart-wrapper {
                height: 200px !important;
                padding: 10px;
            }
        }

        /* Landscape mobile optimization */
        @media (max-width: 896px) and (orientation: landscape) {
            nav {
                position: relative;
            }

            .chart-wrapper {
                height: 200px !important;
            }
        }

        /* Touch device optimizations */
        @media (hover: none) and (pointer: coarse) {
            /* Remove hover effects on touch devices */
            .ingredient-card:hover::before {
                display: none;
            }

            .nav-btn:hover::after {
                display: none;
            }

            /* Add active states instead */
            .ingredient-card:active {
                transform: scale(0.98);
            }

            button:active, .filter-btn:active {
                transform: scale(0.96);
            }

            /* Disable complex animations on touch devices */
            * {
                animation-duration: 0.01s !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.2s !important;
            }

            /* Keep essential animations */
            body, body::before, .sparkle-static {
                animation-duration: 20s !important;
                animation-iteration-count: infinite !important;
            }
        }

        /* Hamburger Menu Styles */
        .hamburger-menu {
            display: none;
            flex-direction: column;
            cursor: pointer;
            padding: 8px;
            z-index: 60;
        }

        .hamburger-menu span {
            display: block;
            width: 28px;
            height: 3px;
            background: #D81B60;
            margin: 4px 0;
            border-radius: 2px;
            transition: all 0.3s ease;
            box-shadow: 0 1px 3px rgba(255, 20, 147, 0.3);
        }

        .hamburger-menu.active span:nth-child(1) {
            transform: rotate(45deg) translate(8px, 8px);
        }

        .hamburger-menu.active span:nth-child(2) {
            opacity: 0;
        }

        .hamburger-menu.active span:nth-child(3) {
            transform: rotate(-45deg) translate(8px, -8px);
        }

        /* Mobile Menu Overlay */
        .mobile-menu {
            display: none;
            position: fixed;
            top: 64px;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(145deg, 
                rgba(255, 255, 255, 0.98) 0%,
                rgba(255, 245, 250, 0.96) 50%,
                rgba(255, 240, 245, 0.98) 100%);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            z-index: 50;
            padding: 2rem;
            overflow-y: auto;
            animation: slideDown 0.3s ease-out;
            box-shadow: inset 0 10px 30px rgba(255, 182, 193, 0.3);
        }

        .mobile-menu.active {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Desktop menu - hide on mobile */
        .desktop-menu {
            display: flex;
        }

        @media (max-width: 768px) {
            .hamburger-menu {
                display: flex;
            }

            .desktop-menu {
                display: none !important;
            }

            .mobile-menu.active .nav-btn {
                width: 100%;
                justify-content: center;
                min-height: 56px;
                font-size: 1.1rem;
            }
        }
    </style>

    <!-- Chosen Palette: Kitchen Sage (Warm Neutrals & Stone) -->
    <!-- Application Structure Plan: 
         1. Dashboard (The "Mentor"): High-level overview, Mode Logic, and Safety Rules visualizations. Purpose: Orient the new owner immediately.
         2. Ingredient Matrix (The "Engine"): Searchable/Filterable grid of all foods. Purpose: The daily reference tool for "Can I cut this?".
         3. Technique & Chutes: Interactive guide on loading food. Purpose: Prevent user error (wedge slices).
         4. Troubleshooting: Accordion logic for errors. Purpose: Quick fixes for common jams.
         Why this structure? The user journey moves from "How does this work?" (Dashboard) to "What can I cook?" (Matrix) to "Something went wrong" (Troubleshoot).
    -->
    <!-- Visualization & Content Choices:
         1. "Safety Prep Distribution" (Doughnut Chart): Breaks down ingredients by prep need (Raw vs Par-cook vs Freeze). Goal: visually reinforce safety.
         2. "Machine Versatility" (Bar Chart): Shows count of ingredients per capability (Slice, Dice, Fry, etc.). Goal: Show machine potential.
         3. Dynamic Cards: Used for ingredients instead of a table for better mobile consumption.
         4. Interactive Lists: Used for troubleshooting to reduce cognitive load.
         5. Logic: Vanilla JS filters. NO SVG/Mermaid. Canvas for charts.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="min-h-screen flex flex-col" style="position: relative; z-index: 0;">

    <!-- Sparkle Container -->
    <div id="sparkle-container"></div>

    <!-- Navigation -->
    <nav class="bg-white shadow-lg sticky top-0 z-50 border-b-2 border-pink-200" style="background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(255, 240, 245, 0.95)); backdrop-filter: blur(10px);">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <span class="text-2xl font-bold tracking-tight pink-glow" style="color: #D81B60;">
                        For My Little Koala Bear Princess <span class="sparkle-static">üê®‚ú®</span>
                    </span>
                </div>
                <!-- Desktop Menu -->
                <div class="desktop-menu items-center space-x-2">
                    <button onclick="switchView('dashboard')" class="nav-btn active px-4 py-2 rounded-md text-sm font-medium transition-colors">Start Here, Little One <span class="sparkle-static">‚ú®</span></button>
                    <button onclick="switchView('ingredients')" class="nav-btn px-4 py-2 rounded-md text-sm font-medium transition-colors" style="color: #8B4A6B;">Your Ingredient Guide <span class="sparkle-static">‚ú®</span></button>
                    <button onclick="switchView('technique')" class="nav-btn px-4 py-2 rounded-md text-sm font-medium transition-colors" style="color: #8B4A6B;">How to Use It <span class="sparkle-static">‚ú®</span></button>
                    <button onclick="switchView('troubleshoot')" class="nav-btn px-4 py-2 rounded-md text-sm font-medium transition-colors" style="color: #8B4A6B;">When Things Go Wrong <span class="sparkle-static">‚ú®</span></button>
                </div>
                <!-- Hamburger Menu -->
                <div class="hamburger-menu" onclick="toggleMobileMenu()">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </div>
    </nav>

    <!-- Mobile Menu Overlay -->
    <div class="mobile-menu" id="mobileMenu">
        <button onclick="switchView('dashboard'); toggleMobileMenu();" class="nav-btn active px-4 py-2 rounded-md text-sm font-medium transition-colors">Start Here, Little One <span class="sparkle-static">‚ú®</span></button>
        <button onclick="switchView('ingredients'); toggleMobileMenu();" class="nav-btn px-4 py-2 rounded-md text-sm font-medium transition-colors" style="color: #8B4A6B;">Your Ingredient Guide <span class="sparkle-static">‚ú®</span></button>
        <button onclick="switchView('technique'); toggleMobileMenu();" class="nav-btn px-4 py-2 rounded-md text-sm font-medium transition-colors" style="color: #8B4A6B;">How to Use It <span class="sparkle-static">‚ú®</span></button>
        <button onclick="switchView('troubleshoot'); toggleMobileMenu();" class="nav-btn px-4 py-2 rounded-md text-sm font-medium transition-colors" style="color: #8B4A6B;">When Things Go Wrong <span class="sparkle-static">‚ú®</span></button>
    </div>

    <!-- Main Content Area -->
    <main id="app-content" class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 w-full" style="position: relative; z-index: 10;">
        <!-- Views will be injected here by JS -->
    </main>

    <!-- Footer -->
    <footer class="py-8 mt-auto" style="background: linear-gradient(135deg, #FF69B4, #FFB6C1); color: white;">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <p class="text-sm font-semibold">Made with love for my little koala bear princess <span class="sparkle-static">üê®üíï‚ú®</span></p>
            <p class="text-xs mt-2 opacity-90">Your special gift guide for the Breville Paradice 16</p>
        </div>
    </footer>

    <!-- JavaScript Logic -->
    <script>
        // --- DATA STORE ---
        const machineStats = {
            totalIngredients: 0,
            prepTypes: { raw: 0, parCook: 0, freeze: 0, other: 0 },
            capabilities: { slice: 0, dice: 0, shred: 0, fry: 0, chop: 0 }
        };

        const ingredientsDB = [
            // Vegetables
            { name: "Artichoke Hearts", cat: "Veg", slice: true, dice: true, shred: false, fry: false, chop: true, note: "Cooked/canned only. Raw is too fibrous.", prep: "Cooked" },
            { name: "Asparagus", cat: "Veg", slice: true, dice: true, shred: false, fry: false, chop: false, note: "Stand vertically in small chute.", prep: "Raw" },
            { name: "Avocado", cat: "Veg", slice: true, dice: true, shred: false, fry: false, chop: true, note: "Must be firm. Soft = puree.", prep: "Raw" },
            { name: "Bamboo Shoots", cat: "Veg", slice: true, dice: true, shred: true, fry: true, chop: true, note: "Great for stir-fry prep.", prep: "Canned/Boiled" },
            { name: "Beans (Green)", cat: "Veg", slice: false, dice: false, shred: false, fry: false, chop: true, note: "Rough chop for casseroles.", prep: "Raw" },
            { name: "Beets", cat: "Veg", slice: true, dice: "Caution", shred: true, fry: false, chop: true, note: "Par-cook if large. Raw is hard.", prep: "Par-Cook" },
            { name: "Bok Choy", cat: "Veg", slice: true, dice: true, shred: false, fry: false, chop: true, note: "Slice stems for stir-fry.", prep: "Raw" },
            { name: "Broccoli", cat: "Veg", slice: true, dice: true, shred: true, fry: false, chop: true, note: "Slice stems (peeled). Chop florets.", prep: "Raw" },
            { name: "Brussels Sprouts", cat: "Veg", slice: true, dice: false, shred: true, fry: false, chop: true, note: "Use Med chute for shaved salad.", prep: "Raw" },
            { name: "Butternut Squash", cat: "Veg", slice: true, dice: "Caution", shred: true, fry: true, chop: true, note: "MUST PAR-COOK. Too hard raw.", prep: "Par-Cook" },
            { name: "Cabbage (Green)", cat: "Veg", slice: true, dice: false, shred: true, fry: false, chop: true, note: "Slice (2mm) for slaw.", prep: "Raw" },
            { name: "Carrots", cat: "Veg", slice: true, dice: "Caution", shred: true, fry: false, chop: true, note: "DANGER. Par-cook large carrots.", prep: "Par-Cook" },
            { name: "Cassava / Yuca", cat: "Veg", slice: true, dice: "Caution", shred: true, fry: true, chop: true, note: "MUST PAR-COOK. Extremely hard.", prep: "Par-Cook" },
            { name: "Cauliflower", cat: "Veg", slice: true, dice: false, shred: false, fry: false, chop: true, note: "Pulse for Cauli-Rice.", prep: "Raw" },
            { name: "Celery", cat: "Veg", slice: true, dice: true, shred: false, fry: false, chop: true, note: "Remove strings. 8mm Mirepoix.", prep: "Raw" },
            { name: "Corn", cat: "Veg", slice: false, dice: false, shred: false, fry: false, chop: true, note: "Pulse kernels for relish.", prep: "Raw" },
            { name: "Cucumber", cat: "Veg", slice: true, dice: true, shred: false, fry: true, chop: true, note: "12mm perfect. Med chute.", prep: "Raw" },
            { name: "Eggplant", cat: "Veg", slice: true, dice: true, shred: false, fry: true, chop: true, note: "Ratatouille / Fries.", prep: "Raw" },
            { name: "Fennel", cat: "Veg", slice: true, dice: true, shred: false, fry: false, chop: true, note: "Paper thin slice.", prep: "Raw" },
            { name: "Garlic", cat: "Veg", slice: true, dice: false, shred: false, fry: false, chop: true, note: "Use Mini-Bowl only.", prep: "Raw" },
            { name: "Ginger", cat: "Veg", slice: true, dice: false, shred: true, fry: false, chop: true, note: "Shred for paste.", prep: "Raw" },
            { name: "Jicama", cat: "Veg", slice: true, dice: true, shred: true, fry: true, chop: true, note: "Dices raw beautifully.", prep: "Raw" },
            { name: "Kale", cat: "Veg", slice: true, dice: false, shred: false, fry: false, chop: true, note: "Roll into cigars to slice.", prep: "Raw" },
            { name: "Mushrooms", cat: "Veg", slice: true, dice: false, shred: false, fry: false, chop: true, note: "Pack sideways in chute.", prep: "Raw" },
            { name: "Onions", cat: "Veg", slice: true, dice: true, shred: false, fry: false, chop: true, note: "Quarter first. 8mm/12mm.", prep: "Raw" },
            { name: "Parsnips", cat: "Veg", slice: true, dice: "Caution", shred: true, fry: true, chop: true, note: "Par-cook recommended.", prep: "Par-Cook" },
            { name: "Peppers (Bell)", cat: "Veg", slice: true, dice: true, shred: false, fry: false, chop: true, note: "Skin-side DOWN on grid.", prep: "Raw" },
            { name: "Potatoes (Russet)", cat: "Veg", slice: true, dice: true, shred: true, fry: true, chop: true, note: "Hash, Fries, Gratin.", prep: "Raw" },
            { name: "Potatoes (Sweet)", cat: "Veg", slice: true, dice: "Caution", shred: true, fry: true, chop: true, note: "MUST PAR-COOK. Hard.", prep: "Par-Cook" },
            { name: "Pumpkin", cat: "Veg", slice: true, dice: "Caution", shred: true, fry: false, chop: true, note: "Par-cook. Shred for baking.", prep: "Par-Cook" },
            { name: "Rutabaga", cat: "Veg", slice: true, dice: "Caution", shred: true, fry: true, chop: true, note: "MUST PAR-COOK. Rock hard.", prep: "Par-Cook" },
            { name: "Shallots", cat: "Veg", slice: true, dice: true, shred: false, fry: false, chop: true, note: "8mm kit. Excellent.", prep: "Raw" },
            { name: "Tomatoes", cat: "Veg", slice: true, dice: true, shred: false, fry: false, chop: true, note: "FIRM Roma only.", prep: "Raw" },
            { name: "Zucchini", cat: "Veg", slice: true, dice: true, shred: true, fry: true, chop: true, note: "Ratatouille / Fries.", prep: "Raw" },
            
            // Fruits
            { name: "Apples", cat: "Fruit", slice: true, dice: true, shred: true, fry: true, chop: true, note: "Pie filling / Fries.", prep: "Raw" },
            { name: "Bananas", cat: "Fruit", slice: true, dice: false, shred: false, fry: false, chop: true, note: "Slice green only.", prep: "Raw" },
            { name: "Berries (Frozen)", cat: "Fruit", slice: false, dice: false, shred: false, fry: false, chop: true, note: "Instant sorbet.", prep: "Frozen" },
            { name: "Cantaloupe", cat: "Fruit", slice: true, dice: true, shred: false, fry: true, chop: true, note: "16mm. Firm only.", prep: "Raw" },
            { name: "Coconut (Fresh)", cat: "Fruit", slice: true, dice: false, shred: true, fry: false, chop: true, note: "Shell removed.", prep: "Raw" },
            { name: "Dates", cat: "Fruit", slice: false, dice: false, shred: false, fry: false, chop: true, note: "MUST FREEZE first.", prep: "Frozen" },
            { name: "Lemons", cat: "Fruit", slice: true, dice: false, shred: false, fry: false, chop: false, note: "2mm for drinks.", prep: "Raw" },
            { name: "Mango", cat: "Fruit", slice: true, dice: true, shred: false, fry: false, chop: true, note: "Must be under-ripe.", prep: "Raw" },
            { name: "Pineapple", cat: "Fruit", slice: false, dice: true, shred: false, fry: false, chop: true, note: "Remove core. 16mm.", prep: "Raw" },
            { name: "Strawberries", cat: "Fruit", slice: true, dice: false, shred: false, fry: false, chop: true, note: "5mm slice. Hull first.", prep: "Raw" },
            { name: "Watermelon", cat: "Fruit", slice: false, dice: true, shred: false, fry: true, chop: true, note: "16mm / Fries.", prep: "Raw" },

            // Pantry/Protein
            { name: "Beef (Raw)", cat: "Pantry", slice: false, dice: false, shred: false, fry: false, chop: true, note: "FREEZE 20 mins. Burger grind.", prep: "Frozen" },
            { name: "Biscuits", cat: "Pantry", slice: false, dice: false, shred: false, fry: false, chop: true, note: "Cut butter into flour.", prep: "Raw" },
            { name: "Cheese (Hard)", cat: "Pantry", slice: false, dice: false, shred: true, fry: false, chop: true, note: "Parmesan snow.", prep: "Raw" },
            { name: "Cheese (Soft)", cat: "Pantry", slice: false, dice: false, shred: "Caution", fry: false, chop: true, note: "Mozz MUST be frozen.", prep: "Frozen" },
            { name: "Chocolate", cat: "Pantry", slice: false, dice: false, shred: true, fry: false, chop: true, note: "Shred for garnish. Cold.", prep: "Raw" },
            { name: "Eggs (Boiled)", cat: "Pantry", slice: false, dice: true, shred: false, fry: false, chop: true, note: "8mm Egg Salad.", prep: "Cooked" },
            { name: "Nuts", cat: "Pantry", slice: true, dice: false, shred: false, fry: false, chop: true, note: "Slice for flakes.", prep: "Raw" },
            { name: "Whipped Cream", cat: "Pantry", slice: false, dice: false, shred: false, fry: false, chop: true, note: "Watch closely! Turns to butter.", prep: "Raw" }
        ];

        // Process Data for Stats
        ingredientsDB.forEach(i => {
            machineStats.totalIngredients++;
            if (i.prep === "Raw") machineStats.prepTypes.raw++;
            else if (i.prep === "Par-Cook" || i.prep === "Cooked") machineStats.prepTypes.parCook++;
            else if (i.prep === "Frozen") machineStats.prepTypes.freeze++;
            else machineStats.prepTypes.other++;

            if (i.slice) machineStats.capabilities.slice++;
            if (i.dice === true || i.dice === "Caution") machineStats.capabilities.dice++;
            if (i.shred === true || i.shred === "Caution") machineStats.capabilities.shred++;
            if (i.fry) machineStats.capabilities.fry++;
            if (i.chop) machineStats.capabilities.chop++;
        });

        // --- VIEWS ---

        const views = {
            dashboard: () => `
                <div class="space-y-8" style="position: relative; z-index: 10;">
                    <section class="text-center mb-10">
                        <h1 class="text-4xl font-bold mb-4 pink-glow" style="color: #D81B60;">Welcome, Little Koala Bear! <span class="sparkle-static">üê®‚ú®</span></h1>
                        <p class="text-lg max-w-2xl mx-auto" style="color: #8B4A6B;">This is your very special gift guide, little one! Your Breville Paradice 16 is like a magical kitchen helper just for you. Let's learn all about how it works together, okay? <span class="sparkle-static">‚ú®</span></p>
                    </section>

                    <!-- How Your Machine Works -->
                    <div class="mb-4 p-4 rounded-lg" style="background: rgba(255, 182, 193, 0.2); border: 2px solid #FFB6C1;">
                        <p class="text-sm" style="color: #8B4A6B;"><strong>üíï Note for You, Little Koala Bear:</strong> Your machine doesn't have "modes" you select - it automatically works based on which attachment you insert! These are just helpful ways to understand how it works inside. <span class="sparkle-static">‚ú®</span></p>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="bg-white p-6 rounded-xl shadow-lg border-l-4" style="border-color: #FFB6C1; box-shadow: 0 4px 15px rgba(255, 182, 193, 0.3);">
                            <h2 class="text-xl font-bold mb-2" style="color: #D81B60;">üå∏ When You Use: Main Spindle <span class="sparkle-static">‚ú®</span></h2>
                            <p class="text-sm mb-4 font-mono" style="color: #8B4A6B;">(Smooth Plastic Spindle - Direct Drive)</p>
                            <p class="text-xs mb-3 italic" style="color: #8B4A6B;">This happens automatically when you insert the Main Spindle, little one!</p>
                            <ul class="space-y-2" style="color: #8B4A6B;">
                                <li class="flex items-center"><span class="mr-2">üî™</span> Chopping (S-Blade)</li>
                                <li class="flex items-center"><span class="mr-2">ü•ñ</span> Dough Kneading</li>
                                <li class="flex items-center"><span class="mr-2">ü•ó</span> Slicing & Shredding</li>
                            </ul>
                            <div class="mt-4 p-3 rounded text-xs" style="background: #FFE4E9; color: #8B4A6B;">
                                <strong>üíï Tip for You, Little Koala:</strong> Disc sits at TOP, S-Blade sits at BOTTOM. <span class="sparkle-static">‚ú®</span>
                            </div>
                        </div>

                        <div class="bg-white p-6 rounded-xl shadow-lg border-l-4" style="border-color: #FF69B4; box-shadow: 0 4px 15px rgba(255, 105, 180, 0.3);">
                            <h2 class="text-xl font-bold mb-2" style="color: #D81B60;">üíñ When You Use: Geared Spindle <span class="sparkle-static">‚ú®</span></h2>
                            <p class="text-sm mb-4 font-mono" style="color: #8B4A6B;">(Metal Teeth Spindle - Geared Drive)</p>
                            <p class="text-xs mb-3 italic" style="color: #8B4A6B;">This happens automatically when you insert the Geared Spindle, little koala bear!</p>
                            <ul class="space-y-2" style="color: #8B4A6B;">
                                <li class="flex items-center"><span class="mr-2">üßä</span> Dicing (8mm, 12mm, 16mm)</li>
                                <li class="flex items-center"><span class="mr-2">‚öôÔ∏è</span> High Torque, Low Speed</li>
                                <li class="flex items-center"><span class="mr-2">‚ö†Ô∏è</span> Needs Dicing Distributor > 5 cups</li>
                            </ul>
                            <div class="mt-4 p-3 rounded text-xs" style="background: #FFE4E9; color: #8B4A6B;">
                                <strong>üíï Remember, Little One:</strong> Spindle -> Distributor -> Grid -> Disc -> Lid. <span class="sparkle-static">‚ú®</span>
                            </div>
                        </div>
                    </div>

                    <!-- Visualizations -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mt-8">
                        <div class="bg-white p-6 rounded-xl shadow-lg" style="box-shadow: 0 4px 15px rgba(255, 182, 193, 0.3); border: 2px solid #FFB6C1;">
                            <h3 class="text-lg font-bold mb-4" style="color: #D81B60;">Safety Prep for My Little Koala Bear <span class="sparkle-static">‚ú®</span></h3>
                            <p class="text-sm mb-4" style="color: #8B4A6B;">Not everything goes in raw, little one. The Dicing Grid needs to be treated gently with hard things. <span class="sparkle-static">‚ú®</span></p>
                            <div class="chart-wrapper">
                                <canvas id="prepChart"></canvas>
                            </div>
                        </div>
                        <div class="bg-white p-6 rounded-xl shadow-lg" style="box-shadow: 0 4px 15px rgba(255, 182, 193, 0.3); border: 2px solid #FFB6C1;">
                            <h3 class="text-lg font-bold mb-4" style="color: #D81B60;">All the Wonderful Things You Can Make! <span class="sparkle-static">‚ú®</span></h3>
                            <p class="text-sm mb-4" style="color: #8B4A6B;">Look at all the amazing ingredients you can work with, little koala bear! <span class="sparkle-static">‚ú®</span></p>
                            <div class="chart-wrapper">
                                <canvas id="capabilityChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Golden Rules -->
                    <section class="p-8 rounded-xl" style="background: linear-gradient(135deg, #FF69B4, #FFB6C1); color: white; box-shadow: 0 8px 25px rgba(255, 105, 180, 0.4);">
                        <h2 class="text-2xl font-bold mb-6 text-center pink-glow">The 3 Special Rules for My Little Koala Bear <span class="sparkle-static">üê®‚ú®</span></h2>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div class="text-center bg-white bg-opacity-20 p-4 rounded-lg">
                                <div class="text-4xl mb-2">üî®</div>
                                <h3 class="font-bold mb-2">The Nail Test</h3>
                                <p class="text-sm text-zinc-600 opacity-90">Can't pierce it with a fingernail, little one? <strong>PAR-COOK IT.</strong> (Sweet Potato, Rutabaga). <span class="sparkle-static">‚ú®</span></p>
                            </div>
                            <div class="text-center bg-white bg-opacity-20 p-4 rounded-lg">
                                <div class="text-4xl mb-2">üëç</div>
                                <h3 class="font-bold mb-2">The Thumb Test</h3>
                                <p class="text-sm text-zinc-600 opacity-90">Can you squish it with your thumb? <strong>TOO SOFT.</strong> (Ripe Tomato, Peach). <span class="sparkle-static">‚ú®</span></p>
                            </div>
                            <div class="text-center bg-white bg-opacity-20 p-4 rounded-lg">
                                <div class="text-4xl mb-2">üå™Ô∏è</div>
                                <h3 class="font-bold mb-2">The Distributor</h3>
                                <p class="text-sm text-zinc-600 opacity-90">Dicing more than 5 cups? Use the fan blade or cubes will pile up and jam, little koala bear. <span class="sparkle-static">‚ú®</span></p>
                            </div>
                        </div>
                    </section>
                </div>
            `,

            ingredients: () => `
                <div class="space-y-6" style="position: relative; z-index: 10;">
                    <section class="mb-6">
                        <h2 class="text-3xl font-bold mb-2 pink-glow" style="color: #D81B60;">Your Special Ingredient Guide, Little Koala Bear <span class="sparkle-static">üê®‚ú®</span></h2>
                        <p class="text-lg" style="color: #8B4A6B;">Check here before you start cooking, little one! <span class="sparkle-static">‚ú®</span></p>
                    </section>

                    <!-- Search & Filter -->
                    <div class="bg-white p-4 rounded-lg shadow-lg sticky top-20 z-40" style="border: 2px solid #FFB6C1; box-shadow: 0 4px 15px rgba(255, 182, 193, 0.3);">
                        <div class="flex flex-col md:flex-row gap-4">
                            <div class="flex-grow">
                                <input type="text" id="searchInput" placeholder="What would you like to make, little one? (e.g., 'Potato', 'Cheese')..." 
                                    class="w-full px-4 py-2 rounded-md focus:ring-2 focus:outline-none" style="border: 2px solid #FFB6C1; color: #8B4A6B; focus:ring-pink-300;">
                            </div>
                            <div class="flex gap-2 overflow-x-auto pb-2 md:pb-0">
                                <button onclick="filterIngredients('all')" class="filter-btn active px-3 py-1 rounded text-sm transition-colors" style="background: linear-gradient(135deg, #FF69B4, #FFB6C1); color: white;">All <span class="sparkle-static">‚ú®</span></button>
                                <button onclick="filterIngredients('Veg')" class="filter-btn px-3 py-1 rounded text-sm transition-colors" style="background: #FFE4E9; color: #8B4A6B; hover:background: #FFB6C1;">Veg <span class="sparkle-static">‚ú®</span></button>
                                <button onclick="filterIngredients('Fruit')" class="filter-btn px-3 py-1 rounded text-sm transition-colors" style="background: #FFE4E9; color: #8B4A6B; hover:background: #FFB6C1;">Fruit <span class="sparkle-static">‚ú®</span></button>
                                <button onclick="filterIngredients('Pantry')" class="filter-btn px-3 py-1 rounded text-sm transition-colors" style="background: #FFE4E9; color: #8B4A6B; hover:background: #FFB6C1;">Pantry <span class="sparkle-static">‚ú®</span></button>
                            </div>
                        </div>
                        <div class="flex gap-2 mt-2 overflow-x-auto">
                             <label class="flex items-center space-x-2 text-sm px-2 py-1 rounded" style="background: #FFE4E9; color: #8B4A6B;">
                                <input type="checkbox" onchange="toggleCapability('dice')" style="accent-color: #FF69B4;">
                                <span>Can Dice <span class="sparkle-static">‚ú®</span></span>
                            </label>
                            <label class="flex items-center space-x-2 text-sm px-2 py-1 rounded" style="background: #FFE4E9; color: #8B4A6B;">
                                <input type="checkbox" onchange="toggleCapability('fry')" style="accent-color: #FF69B4;">
                                <span>Can Fry <span class="sparkle-static">‚ú®</span></span>
                            </label>
                            <label class="flex items-center space-x-2 text-sm px-2 py-1 rounded" style="background: #FFE4E9; color: #8B4A6B;">
                                <input type="checkbox" onchange="toggleCapability('shred')" style="accent-color: #FF69B4;">
                                <span>Can Shred <span class="sparkle-static">‚ú®</span></span>
                            </label>
                        </div>
                    </div>

                    <!-- Grid -->
                    <div id="ingredientGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <!-- Cards injected here -->
                    </div>
                </div>
            `,

            technique: () => `
                <div class="space-y-8" style="position: relative; z-index: 10;">
                    <section class="text-center">
                        <h2 class="text-3xl font-bold pink-glow" style="color: #D81B60;">How to Use Your Gift, Little Koala Bear <span class="sparkle-static">üê®‚ú®</span></h2>
                        <p class="mt-2 text-lg" style="color: #8B4A6B;">How you load the chute determines if you get perfect "Coins" or "Tongues", little one! <span class="sparkle-static">‚ú®</span></p>
                    </section>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="bg-white p-6 rounded-xl shadow-lg border-t-4" style="border-color: #FF69B4; box-shadow: 0 4px 15px rgba(255, 182, 193, 0.3);">
                            <div class="text-center mb-4 text-4xl">üóëÔ∏è</div>
                            <h3 class="text-xl font-bold text-center mb-2" style="color: #D81B60;">Large Chute <span class="sparkle-static">‚ú®</span></h3>
                            <p class="text-sm text-center mb-4" style="color: #8B4A6B;">"The Bucket"</p>
                            <p class="text-sm" style="color: #8B4A6B;">Best for whole potatoes, cabbage wedges, block cheese, little koala bear!</p>
                            <div class="mt-4 p-3 rounded text-xs border" style="background: #FFF0F5; color: #8B4A6B; border-color: #FFB6C1;">
                                <strong>üíï Remember, Little One:</strong> Pack it TIGHT. A single carrot here will fall over and cut diagonally. <span class="sparkle-static">‚ú®</span>
                            </div>
                        </div>

                        <div class="bg-white p-6 rounded-xl shadow-lg border-t-4" style="border-color: #FFB6C1; box-shadow: 0 4px 15px rgba(255, 182, 193, 0.3);">
                            <div class="text-center mb-4 text-4xl">ü•í</div>
                            <h3 class="text-xl font-bold text-center mb-2" style="color: #D81B60;">Medium Chute <span class="sparkle-static">‚ú®</span></h3>
                            <p class="text-sm text-center mb-4" style="color: #8B4A6B;">"The stabilizer"</p>
                            <p class="text-sm" style="color: #8B4A6B;">Best for Cucumbers, Zucchini, Small Potatoes, little one!</p>
                            <div class="mt-4 p-3 rounded text-xs border" style="background: #FFF0F5; color: #8B4A6B; border-color: #FFB6C1;">
                                <strong>üíï Perfect for You:</strong> Use this for perfect rounds. It prevents wobble, little koala bear! <span class="sparkle-static">‚ú®</span>
                            </div>
                        </div>

                        <div class="bg-white p-6 rounded-xl shadow-lg border-t-4" style="border-color: #FFC0CB; box-shadow: 0 4px 15px rgba(255, 182, 193, 0.3);">
                            <div class="text-center mb-4 text-4xl">ü•ï</div>
                            <h3 class="text-xl font-bold text-center mb-2" style="color: #D81B60;">Small Chute <span class="sparkle-static">‚ú®</span></h3>
                            <p class="text-sm text-center mb-4" style="color: #8B4A6B;">"The Precision Tool"</p>
                            <p class="text-sm" style="color: #8B4A6B;">Best for Carrots, Celery, Pepperoni, Leeks, little one!</p>
                            <div class="mt-4 p-3 rounded text-xs border" style="background: #FFF0F5; color: #8B4A6B; border-color: #FFB6C1;">
                                <strong>üíï Special Tip:</strong> Use the tiny hole at the bottom to drizzle oil for mayo, little koala bear! <span class="sparkle-static">‚ú®</span>
                            </div>
                        </div>
                    </div>

                    <div class="p-8 rounded-xl mt-8" style="background: linear-gradient(135deg, #FF69B4, #FFB6C1); color: white; box-shadow: 0 8px 25px rgba(255, 105, 180, 0.4);">
                        <h3 class="text-2xl font-bold mb-4 pink-glow">Can You Put It in the Dishwasher, Little Koala Bear? <span class="sparkle-static">üê®‚ú®</span></h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <div class="bg-white bg-opacity-20 p-4 rounded-lg">
                                <h4 class="font-bold mb-2 text-lg">‚úÖ YES (Top Shelf) <span class="sparkle-static">‚ú®</span></h4>
                                <ul class="space-y-2 opacity-90 list-disc pl-5">
                                    <li>Bowl & Lid (Avoid "Sanitize" cycle, little one)</li>
                                    <li>All Pushers</li>
                                    <li>S-Blade, Dough Blade, Mini Blade</li>
                                    <li>Slicing & Shredding Discs</li>
                                    <li><strong>Dicing Grid</strong> (Use Cleaning Cap first, little koala bear!)</li>
                                </ul>
                            </div>
                            <div class="bg-white bg-opacity-20 p-4 rounded-lg">
                                <h4 class="font-bold mb-2 text-lg">üõë NO (Hand Wash Only) <span class="sparkle-static">‚ú®</span></h4>
                                <ul class="space-y-2 opacity-90 list-disc pl-5">
                                    <li><strong>The Dicing Gearbox</strong> (Greased gears inside, little one)</li>
                                    <li>The Motor Base</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            `,

            troubleshoot: () => `
                <div class="max-w-2xl mx-auto space-y-6" style="position: relative; z-index: 10;">
                    <section class="text-center mb-8">
                        <h2 class="text-3xl font-bold pink-glow" style="color: #D81B60;">Don't Worry, Little Koala Bear! <span class="sparkle-static">üê®‚ú®</span></h2>
                        <p class="text-lg" style="color: #8B4A6B;">It's usually just a safety feature, little one. We'll fix it together! <span class="sparkle-static">‚ú®</span></p>
                    </section>

                    <div class="space-y-4">
                        ${renderAccordion("Machine won't start (Timer blinking)", `
                            <ol class="list-decimal pl-5 space-y-2" style="color: #8B4A6B;">
                                <li>Is the <strong>Bowl</strong> locked, little koala bear? (Handle front-center)</li>
                                <li>Is the <strong>Lid</strong> locked? (Align lines, little one)</li>
                                <li><strong>IMPORTANT:</strong> Is the <strong>LARGE PUSHER</strong> inserted? The machine will NOT run if the chute is open, little koala bear!</li>
                            </ol>
                        `)}
                        ${renderAccordion("Screen flashing 'OVERLOAD'", `
                            <p class="mb-2" style="color: #8B4A6B;">The motor is overheated or jammed, little one.</p>
                            <ul class="list-disc pl-5 space-y-2" style="color: #8B4A6B;">
                                <li>Unplug immediately, little koala bear.</li>
                                <li>Clear the jam (check dicing grid, little one).</li>
                                <li><strong>WAIT 30 MINUTES.</strong> The thermal fuse needs to cool, okay? <span class="sparkle-static">‚ú®</span></li>
                            </ul>
                        `)}
                        ${renderAccordion("Lid is stuck!", `
                            <p class="mb-2" style="color: #8B4A6B;">Vacuum seal created by hot food or liquid, little koala bear.</p>
                            <ul class="list-disc pl-5 space-y-2" style="color: #8B4A6B;">
                                <li>Remove the <strong>Small Pusher</strong> first to break the vacuum, little one.</li>
                                <li>Unlock bowl from base <em>before</em> removing lid, okay? <span class="sparkle-static">‚ú®</span></li>
                            </ul>
                        `)}
                        ${renderAccordion("Slices are wedge-shaped", `
                            <p style="color: #8B4A6B;">Food fell over in the large chute, little koala bear. Pack it tighter or use the Medium/Small chute for support, okay? <span class="sparkle-static">‚ú®</span></p>
                        `)}
                    </div>
                </div>
            `
        };

        // --- RENDER HELPERS ---

        function renderAccordion(title, content) {
            const id = title.replace(/\s+/g, '');
            return `
                <div class="rounded-lg bg-white overflow-hidden shadow-lg" style="border: 2px solid #FFB6C1; box-shadow: 0 4px 15px rgba(255, 182, 193, 0.3);">
                    <button onclick="toggleAccordion('${id}')" class="w-full px-6 py-4 text-left flex justify-between items-center transition-colors" style="color: #D81B60; hover:background: #FFE4E9;">
                        <span class="font-bold">${title} <span class="sparkle-static">‚ú®</span></span>
                        <span id="icon-${id}" class="transition-transform transform" style="color: #FF69B4;">‚ñº</span>
                    </button>
                    <div id="content-${id}" class="hidden px-6 py-4 border-t" style="background: #FFF0F5; border-color: #FFB6C1;">
                        ${content}
                    </div>
                </div>
            `;
        }

        function renderIngredientCard(item) {
            const getStatus = (val) => {
                if (val === true) return '<span style="color: #10B981;">‚úÖ</span>';
                if (val === "Caution") return '<span style="color: #F59E0B;">‚ö†Ô∏è</span>';
                return '<span style="color: #E5E7EB;">‚ùå</span>';
            };

            const prepColor = item.prep === "Raw" ? "background: #D1FAE5; color: #065F46;" : 
                              item.prep === "Frozen" ? "background: #DBEAFE; color: #1E40AF;" :
                              "background: #FED7AA; color: #92400E;"; // Par-Cook/Cooked

            return `
                <div class="ingredient-card bg-white p-5 rounded-lg flex flex-col h-full" style="border: 2px solid #FFB6C1; box-shadow: 0 4px 15px rgba(255, 182, 193, 0.3);">
                    <div class="flex justify-between items-start mb-3">
                        <h3 class="font-bold text-lg" style="color: #D81B60;">${item.name} <span class="sparkle-static">‚ú®</span></h3>
                        <span class="text-xs font-bold px-2 py-1 rounded-full" style="${prepColor}">${item.prep}</span>
                    </div>
                    
                    <div class="grid grid-cols-5 gap-1 mb-4 text-center text-xs">
                        <div class="flex flex-col items-center p-1 rounded" style="background: #FFE4E9;"><span style="color: #8B4A6B;">Slice</span>${getStatus(item.slice)}</div>
                        <div class="flex flex-col items-center p-1 rounded" style="background: #FFE4E9;"><span style="color: #8B4A6B;">Dice</span>${getStatus(item.dice)}</div>
                        <div class="flex flex-col items-center p-1 rounded" style="background: #FFE4E9;"><span style="color: #8B4A6B;">Shred</span>${getStatus(item.shred)}</div>
                        <div class="flex flex-col items-center p-1 rounded" style="background: #FFE4E9;"><span style="color: #8B4A6B;">Fry</span>${getStatus(item.fry)}</div>
                        <div class="flex flex-col items-center p-1 rounded" style="background: #FFE4E9;"><span style="color: #8B4A6B;">Chop</span>${getStatus(item.chop)}</div>
                    </div>

                    <div class="mt-auto pt-3 border-t" style="border-color: #FFB6C1;">
                        <p class="text-sm italic" style="color: #8B4A6B;">"${item.note}" <span class="sparkle-static">‚ú®</span></p>
                    </div>
                </div>
            `;
        }

        // --- LOGIC ---

        // Toggle Mobile Menu
        function toggleMobileMenu() {
            const mobileMenu = document.getElementById('mobileMenu');
            const hamburger = document.querySelector('.hamburger-menu');
            
            mobileMenu.classList.toggle('active');
            hamburger.classList.toggle('active');
        }

        function switchView(viewName) {
            // Smooth fade out transition
            const app = document.getElementById('app-content');
            app.style.opacity = '0';
            app.style.transform = 'translateY(10px)';
            
            setTimeout(() => {
                // Update Tab UI
                document.querySelectorAll('.nav-btn').forEach(btn => {
                    btn.classList.remove('active');
                    btn.style.background = '#FFE4E9';
                    btn.style.color = '#8B4A6B';
                });
                const activeBtn = Array.from(document.querySelectorAll('.nav-btn')).find(b => b.getAttribute('onclick').includes(viewName));
                if(activeBtn) {
                    activeBtn.classList.add('active');
                    activeBtn.style.background = 'linear-gradient(135deg, #FF69B4, #FFB6C1)';
                    activeBtn.style.color = 'white';
                }

                // Inject Content
                app.innerHTML = views[viewName]();
                
                // Fade in with animation
                setTimeout(() => {
                    app.style.opacity = '1';
                    app.style.transform = 'translateY(0)';
                }, 50);

                // Initialize Page Specific Logic
                if (viewName === 'dashboard') {
                    setTimeout(() => initCharts(), 100);
                }
                if (viewName === 'ingredients') {
                    setTimeout(() => initGrid(), 100);
                }
            }, 200);
        }

        function initCharts() {
            // Prep Requirement Chart
            const ctxPrep = document.getElementById('prepChart').getContext('2d');
            new Chart(ctxPrep, {
                type: 'doughnut',
                data: {
                    labels: ['Raw (Easy)', 'Par-Cook / Cooked (Hard)', 'Frozen (Soft/Meat)'],
                    datasets: [{
                        data: [machineStats.prepTypes.raw, machineStats.prepTypes.parCook, machineStats.prepTypes.freeze],
                        backgroundColor: ['#FFB6C1', '#FF69B4', '#FFC0CB'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom', labels: { color: '#8B4A6B' } }
                    }
                }
            });

            // Capability Chart
            const ctxCap = document.getElementById('capabilityChart').getContext('2d');
            new Chart(ctxCap, {
                type: 'bar',
                data: {
                    labels: ['Slice', 'Dice', 'Shred', 'Fry', 'Chop'],
                    datasets: [{
                        label: 'Compatible Ingredients',
                        data: [
                            machineStats.capabilities.slice,
                            machineStats.capabilities.dice,
                            machineStats.capabilities.shred,
                            machineStats.capabilities.fry,
                            machineStats.capabilities.chop
                        ],
                        backgroundColor: ['#FFB6C1', '#FF69B4', '#FFC0CB', '#FFE4E9', '#FF1493'],
                        borderRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { 
                            beginAtZero: true, 
                            grid: { display: false },
                            ticks: { color: '#8B4A6B' }
                        },
                        x: { 
                            grid: { display: false },
                            ticks: { color: '#8B4A6B' }
                        }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        }

        // Ingredient Filter Logic
        let activeCategory = 'all';
        let capabilityFilters = { dice: false, fry: false, shred: false };

        function initGrid() {
            renderGrid();
            
            // Re-attach listener for search since DOM was replaced
            document.getElementById('searchInput').addEventListener('input', (e) => {
                renderGrid(e.target.value);
            });
        }

        function filterIngredients(cat) {
            activeCategory = cat;
            document.querySelectorAll('.filter-btn').forEach(b => {
                b.classList.remove('active');
                b.style.background = '#FFE4E9';
                b.style.color = '#8B4A6B';
                if(b.textContent.includes(cat === 'all' ? 'All' : cat)) {
                    b.classList.add('active');
                    b.style.background = 'linear-gradient(135deg, #FF69B4, #FFB6C1)';
                    b.style.color = 'white';
                }
            });
            renderGrid(document.getElementById('searchInput').value);
        }

        function toggleCapability(cap) {
            capabilityFilters[cap] = !capabilityFilters[cap];
            renderGrid(document.getElementById('searchInput').value);
        }

        function renderGrid(searchTerm = "") {
            const grid = document.getElementById('ingredientGrid');
            if (!grid) return;

            const term = searchTerm.toLowerCase();
            
            const filtered = ingredientsDB.filter(item => {
                // Category Filter
                if (activeCategory !== 'all' && item.cat !== activeCategory) return false;
                
                // Search Filter
                if (!item.name.toLowerCase().includes(term)) return false;

                // Capability Filters (AND logic for checkboxes)
                if (capabilityFilters.dice && (item.dice === false)) return false;
                if (capabilityFilters.fry && (item.fry === false)) return false;
                if (capabilityFilters.shred && (item.shred === false)) return false;

                return true;
            });

            grid.innerHTML = filtered.map(renderIngredientCard).join('');
            
            if (filtered.length === 0) {
                grid.innerHTML = `<div class="col-span-full text-center py-10" style="color: #8B4A6B;">No ingredients found matching criteria, little koala bear. Try a different search! <span class="sparkle-static">‚ú®</span></div>`;
            }
        }

        // Troubleshoot Accordion Logic
        window.toggleAccordion = function(id) {
            const content = document.getElementById(`content-${id}`);
            const icon = document.getElementById(`icon-${id}`);
            if (content.classList.contains('hidden')) {
                content.classList.remove('hidden');
                icon.style.transform = 'rotate(180deg)';
            } else {
                content.classList.add('hidden');
                icon.style.transform = 'rotate(0deg)';
            }
        };

        // Enhanced Sparkle Animation System
        function createSparkle() {
            const sparkle = document.createElement('div');
            sparkle.className = 'sparkle';
            const sparkleChars = ['‚ú®', '‚≠ê', 'üí´', '‚ú®', '‚ú®'];
            sparkle.textContent = sparkleChars[Math.floor(Math.random() * sparkleChars.length)];
            
            // More sophisticated positioning and sizing
            const startX = Math.random() * 100;
            const size = Math.random() * 12 + 16;
            const duration = Math.random() * 4 + 6;
            const opacity = Math.random() * 0.4 + 0.6;
            
            sparkle.style.left = startX + '%';
            sparkle.style.animationDelay = Math.random() * 0.5 + 's';
            sparkle.style.animationDuration = duration + 's';
            sparkle.style.fontSize = size + 'px';
            sparkle.style.opacity = opacity;
            sparkle.style.filter = `drop-shadow(0 0 ${size/2}px rgba(255, 182, 193, ${opacity}))`;
            
            // Add slight horizontal drift
            const drift = (Math.random() - 0.5) * 30;
            sparkle.style.setProperty('--drift', drift + 'px');
            
            document.getElementById('sparkle-container').appendChild(sparkle);
            
            setTimeout(() => {
                if (sparkle.parentNode) {
                    sparkle.remove();
                }
            }, (duration + 2) * 1000);
        }

        // Create sparkles periodically with better distribution
        function initSparkles() {
            // More frequent, smaller batches
            setInterval(() => {
                if (Math.random() > 0.2) { // 80% chance
                    createSparkle();
                }
            }, 250);
            
            // Create initial sparkles with staggered timing
            for (let i = 0; i < 12; i++) {
                setTimeout(() => createSparkle(), i * 120);
            }
        }

        // Init
        switchView('dashboard');
        initSparkles();

    </script>
</body>
</html>